<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPA Test View</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <style>
        th,td {
            padding: 0.5rem;
            vertical-align: top;
            border: 1px solid #dee2e6;
        }

        #rpaTable select {
            padding: 2px;
            font-size: 0.9rem;
        }

        #rpaTable td {
            white-space: nowrap;
        }

        .btn-scale {
            transition: transform 0.1s ease-out;
        }

        .btn-scale:active {
            transform: scale(0.95);
        }

        .bi-play-circle:hover {
            opacity: 0.7;
            color: #198754;
            cursor: pointer;
        }



        
    </style>

</head>
<body>

    <section class="d-flex">
        <div>
            <table id="receiptsDataTable" class="rcpTable mt-2" data-loading="0" style="max-width: 500px;">                
                <tbody> 
                    <tr>
                        <td class="rcpLabel"><span>Firma:</span> </td>
                        <td class="rcpValue" id="rcp-firm" data-field="firm">ABB</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel"><span>Adres:</span></td>
                        <td class="rcpValue" id="rcp-addr" data-field="addr">ABB Adres</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Tarih:</td>
                        <td class="rcpValue" id="rcp-date" data-field="date">2023-01-01</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Saat:</td>
                        <td class="rcpValue" id="rcp-time" data-field="time"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">KDV Tutarı:</td>
                        <td class="rcpValue" id="rcp-kdv" data-field="kdv"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Toplam</td>
                        <td class="rcpValue" id="rcp-total" data-field="total"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Fatura No:</td>
                        <td class="rcpValue" id="rcp-inv_no" data-field="inv_no">Aaf322342431234adaf</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Fiş No:</td>
                        <td class="rcpValue" id="rcp-rcp_no" data-field="rcp_no"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Araç Plaka No:</td>
                        <td class="rcpValue" id="rcp-pln" data-field="pln"></td>
                        <td class="rcpActions"></td>                        
                    </tr>
                    <tr>
                        <td class="rcpLabel">Vergi Dairesi:</td>
                        <td class="rcpValue" id="rcp-vd" data-field="vd">ÇORLU VD</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel"><span>Vergi No:</span></td>
                        <td class="rcpValue" id="rcp-vn" data-field="vn">4562232323</td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Müşteri Vergi Dairesi:</td>
                        <td class="rcpValue" id="rcp-mvd" data-field="mvd"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Müşteri VN:</td>
                        <td class="rcpValue" id="rcp-mvn" data-field="mvn"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr class="vatTableTr">
                        <td class="rcpLabel">KDV Oranları</td>
                        <td class="tdVATtable">
                            <div>
                                <table id="rcpVATtable" class="rcpVATtable w-100">
                                    <thead></thead>
                                    <tbody></tbody>
                                </table>
                                
                            </div>
                        </td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Açıklama</td>
                        <td class="rcpValue not-editable" id="rcp-desc" data-field="desc"></td>
                        <td class="rcpActions"></td>
                    </tr>
                    <tr>
                        <td class="rcpLabel">Belge Yükleme Tarihi</td>
                        <td class="rcpValue not-editable" id="rcp-dt" data-field="dt"></td>
                        <td></td>
                    </tr>
                    <tr class="d-none">
                        <td class="rcpLabel">Belgeyi Yükleyen Kişi</td>
                        <td class="rcpValue not-editable" id="rcp-kim" data-field="kim"></td>
                        <td></td>
                    </tr>
                    <tr class="d-none">
                        <td class="rcpLabel">Değişlik için Açıklama</td>
                        <td class="rcpValue" id="rcp-update_desc" data-field="update_desc"></td>
                        <td class="rcpActions"></td>
                    </tr>
                </tbody>
            </table>  

        </div>
        <div>
            <div class="d-flex justify-content-between p-2">
                <div class="form-check">
                    <select name="rpa-helper" id="rpa-helper" style="padding: 3px;">
                        <option value="mouse-click">Mouse Tık</option>
                        <option value="keyboard-today">Tarih Girişi</option>
                        <option value="keyboard-input">Metin Girişi</option>
                        <option value="keyboard-enter">Enter Tuşu</option>
                        <option value="keyboard-tab">Tab Tuşu</option>
                    </select>
                    <span title="RPA iş akışına ekle" style="cursor: pointer;">
                        <i class="bi bi-plus-circle text-success" id="addHelperAction"></i>
                    </span>
                </div>
                <div class="form-check ms-4">
                    <div class="d-flex">                    
                        <div>                        
                            <label class="form-check-label" for="rpa-edit-mode">
                                <span class="text-secondary">Değişiklik Modu</span>
                            </label>
                            <input class="form-check-input custom-visible" type="checkbox" id="rpa-edit-mode" title="RPA akışında değişiklik yapmak için işaretleyiniz." onchange="enableDisableRPAeditMode(this)">
                        </div>
                    </div>
                </div> 
            </div>
            <table id="rpaTable" class="rcpTable mt-2 ms-4" data-loading="0" style="max-width: 300px;">
                <thead>
                    <tr>
                        <th colspan="6">RPA İŞ AKIŞI</th>
                        <th colspan="2" class="fs-5 text-center text-success fw-bold"><i class="bi bi-play-circle" title="RPA İş Akışını Başlat" onclick="startRPAWorkflow()"></i></th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
        

            

    </section>

    <div id="resultMessage" style="position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 2055; min-width: 300px; max-width: 90%; display: none;"></div>


    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- START: Message Display ---

        const resultMessageEl = document.getElementById('resultMessage');

        function gosterMessage(strong, text, type = "info") {
            if (!resultMessageEl) return;
            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    <strong>${strong}</strong> ${text}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            resultMessageEl.innerHTML = ''; // Clear previous message
            resultMessageEl.appendChild(wrapper);
            resultMessageEl.style.display = "block";
            fadeOutAfterShowingMessage(resultMessageEl);
        }

        function fadeOutAfterShowingMessage(el, duration = 3000) {
            setTimeout(() => {
                el.querySelector('.alert')?.classList.remove('show');
                setTimeout(() => {
                    el.style.display = 'none';
                }, 1000); // Match Bootstrap's fade duration
            }, duration);
        }
        // --- END: Message Display ---
    </script>

    <script src="{{ url_for('static', filename='js/rpa.js') }}?v=1.01"></script>

    
</body>
</html>